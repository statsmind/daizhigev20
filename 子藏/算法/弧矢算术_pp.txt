钦定四库全书     子部六
弧矢筭术       天文算法类二【算书之属】提要
【臣】等谨案：弧矢算术一卷，明顾应祥撰应祥，有人代纪要，巳着録弧矢之法始于元郭守敬授时厯草其有弧背求矢，草立天元一为矢云云，反覆求之，至得三乘，方积数及廉隅，纵数而止，不载开方筭式，大抵开诸乗方法尚为当时畴人所习，抑或别有専书皆不可知，其矢相求，及弧容直，濶诸法皆以勾股法御之，明唐顺之，谓为步日躔，月离源头作弧矢，论以示顾，应祥应祥遂演为是书，名其编曰：弧矢算术，应祥未明，立天元一法，故置之不论，惟补其开带，纵三乗之式并详各矢，相求之法与测圆海镜，分类释术之作相同，亦専备其数，使学者可考而已。乾隆四十六年二月恭校上。
总纂官，【臣】纪昀，【臣】陆锡熊，【臣】孙，士毅。
总 校 官 【臣】 陆 费 墀
弧矢算术序
弧矢一术，古今算法所载者，絶少钱唐呉，信民九章法，止载一条，四元玉鉴所载数条，皆不言其所以然之故，沈存中梦溪笔谈有割圆之法，虽自谓造微，然止于径矢求，而于弧背求矢，截积求矢，诸法俱未备，予每病之南，曹讼牒颇暇，乃取诸家算书，间附己意，各立一法，名曰弧矢，算术，藏诸箧笥，俟高明之士取正焉，未敢谓尽得其阃奥也，嘉靖壬子春三月吉，吴兴顾应祥识。
弧矢论说
弧矢者，割圆之法也。割平圆之旁，状若弧矢，故谓之弧矢，其背曲曰：弧背其直，曰弧其中，衡曰：矢而皆取法于径，径也者，平圆中心之径也，背有曲直，有脩短，系于圆之大小，圆大则径长，圆小则径短，非径无以定之，故曰：取则于径，而其法不出于勾股，开方之术，以矢求，则以半径为半径，减矢为股股，各自乗相减，余为实，平方开之，得勾勾，即半截也，以求矢，亦以半径为半截，为勾勾，各自乗相减，余为实，平方开之，得股股，乃半径减矢之余也，以减半径即矢，或以矢减全径为勾股，和以矢为勾股，较乘之，亦得勾筭，即半截筭也，矢自乗圆径除之，得半背差，倍以加，即弧背，以半背差除，矢筭亦得，圆径半截，自乗为实以矢除之，得矢径差加矢，即圆径以矢加，以矢乗而半之，即所截之积也，倍截积，以矢除之，减矢即倍截积，以为从，方开之即矢，惟弧背与径求矢，截积与径求矢，开方不能尽用三乗方法开之，弧背求矢，以半弧背筭，与径筭相乗为实径乗径筭为从方，径筭为上亷全背与径相乗为下亷约矢乗上亷以减从方以矢自乗以减下亷又以矢乗余下亷与减余从方为法，除实得矢，曷为以矢乗上防减从方也，盖从方乃径与径，筭相乗其中多一矢乗径筭之数，故减之，曷为又以矢自乗以减下亷也下亷乃背径相乗其中多一矢自乗之数，故亦减之，减之，则法与实相合矣，以截积求矢，则倍积自乗为实，四因积为上亷四因径为下亷五为负隅，约矢以隅因之，以减下亷又以矢一度乗上亷两度乗下亷并而为法，矢减下亷者何也矢本减径而得，故减径以求之，五为负隅者，何也？凡以方为圆，毎一寸，得虚隅二分五厘，四其虚隅，与四，其矢合而为五也。四其亷者何也倍积则乗出之数为积者四，故亦四其亷以就之升法，以就实也，若以截与截余外周求矢，则以筭半，筭相乗四而三之为实，并及余周为益，方半乗加筭，为从上亷并亷及余周为下亷以约出之矢乗上亷又以矢自乗再乗为隅法并上亷以减益方矢，自之以乗下亷并减余从方为法，除实得矢。
方圆论说【附】
世之习算者，咸以方五斜七围，三径一为凖，殊不知方五则，斜七有奇，径一，则围三有奇，故古人立法，有勾三股，四五之论，而不能使方斜为一定之法，有割圆矢，之论而不能使方圆为一定之法，试以勾股法求之，勾股各自乗并为实，平方开之，此施之于长直方则可，若一整方勾五股，五各自乗并得五十，平方开之，得七而又多一筭矣，割圆之法，求矢求，固是至于求弧背，则恐未尽也，何以知之？试以平圆径，十寸者，例之中心，剖开矢，阔五寸自乗得二十五寸，以径除之，得二寸五分，为半背，差倍之，得五寸，以加得一十五寸，与围三径，一之论正合，然径一，则围三有竒奇数则不能尽矣，以是知弧背之説犹未尽也，不特是也。凡平圆一十二立，圆三十六，皆不过取其大较耳，或曰宻率径七则围二十二，徽率径五十，则围一百五十七，何不取二术，酌之以立，一定之法，曰：二术以圆为方，以方为圆，非不可，但其还原，与原数不合，数多则散漫难收，故算厯者止用径一围三，亦势之不得已也？曰：厯家以径一围三立法，则其数似犹未精，然郭守敬之厯至今行之无弊，何也？曰：厯家以万分为度，秒以下皆不録，纵有小差，不出于一度之中，况所谓黄赤道弧背度，乃测验而得止，以径一围三，定其平差立差耳，虽然，行之日久，安保其不差也。窃尝思之，天地之道隂阳而已方圆天地也，方象法地，静而有质，故可以象数求之，圆象法天，动而无形，故不可以象数求之，方体本静，而中斜者，乃动而生阳者也，圆体本动，而中心之径，乃静而根隂者也天外阳而内隂地外隂而内阳隂阳交错而万物化生，其机正在于奇零，不齐之处，上智不能测，巧厯不能尽者也，向使天地之道，俱可以限量，求之则化，机有尽而不能生万物矣，余因论方圆之法，而并着其理如此。
钦定四库全书
弧矢筭术       明 顾应祥 撰
圆径与截矢求截
术曰：半径为半径，减矢为股，各自乗相减，余为勾筭，平方开之，得勾即半截。
又曰以矢减径以矢乗之即半截筭
圆径十寸从旁截一弧矢阔一寸问截
答曰六寸
术曰：半径自之，得二十五 ，半径减矢自之，得一十六寸相减，余九，平方开之，得三倍之，即截。
又曰：圆径自之，得一百为，筭圆径减，倍矢自之，得六十四，为股筭相减，余三十六为勾筭，平方开之，得全。
圆径十三步截矢阔四歩问截
答曰十二歩
术曰：半径筭四十二步，【二五】减矢半径，筭六歩【二五】相减，余三十六歩为勾筭。
又曰：全径筭一百六十九 ，减倍矢径筭，二十五相减，余一百四十四，平方开之，得全截。
圆径九十歩截矢九歩问截
答曰五十四步
术同
圆材径二尺五寸锯板欲厚七寸问阔几何
答曰板阔二尺四寸
术曰：圆径为自之，得六十二尺五寸， 板厚为勾自之，得四尺九寸相减，得五十七尺六寸为股筭，平方开之。
【阙】
<子部,天文算法类,算书之属,弧矢算术,弧矢算术>
<子部,天文算法类,算书之属,弧矢算术,弧矢算术>
商得
一寸 置一于左上为法 置一乗上亷仍得一十四寸 置一隅因得五以减下亷余三十五寸 置一自之以乗下亷仍得三十五寸并上亷得四十九为下法
圆径九十，歩从旁截积二百八十三歩半问截矢，答曰：矢九歩。
术曰倍积自之得三十二万一千四百八十九歩为正实 四因积得一千一百三十四为上亷 四因径得三百六十为下亷 五为负隅 商得九 置一于左上为法 置一乗上亷得一万○二百○六置一隅因得四十五以减下亷余三百一十五 置一自之以乗余下亷得二万五千五百一十五并上亷共二万五千七百二十一为下法
圆径九十歩从旁截积八百一十歩问矢
荅曰矢一十八歩
术曰：倍积自之，得二百六十二万四千四百爲正，实四因截，积得三千二百四十，为从上亷 四因圆。
径得三百六十为从下亷 五爲负隅 初商一十置一于左上为法 置一乗上亷得三万二千四
百 置一，以隅因之，得五十以减，从下亷余三百一十 ，置一自之以乗余下亷得三万一千 ，并上亷共六万三千四百，为下法，与上法相乗除实六十三万四千 ，余实一百九十九万，○四百未尽 ，倍上亷得六万四千八百，初商自之，三因得三百，为下亷方法 初商，三之，得三十为下亷亷法 初商自乗再乗隅因得五千，为下亷减隅 次商八 ，置一于左上为法， 置一乗上亷得二万五千九百二十，并倍上亷共九万○七百二十 ，置一并入初商，得一十八，以隅因之，得九十，以减从下亷余二百七十以方法乗之得八万一千 ，置一乗亷法得二百四十以乗余下亷得六万四千八百 ，置一自之，得六十四以乗余下亷得一万七千二百八十，减去减隅五千，止存一万二千二百八十 下亷方亷隅共一十五万八千，○八十并上亷共二十四万八千八百，为下法，与上法相乗除实尽。
又术：次商八 ，置一于左上为法， 倍初商，加次商得二十八以乗上亷得九万○七百二十 ，置一隅，因得四十以减，余下亷止存二百七十倍，初，商加次商，并初次商因之，得五百○四，加初商自之一百，共六百○，四以乗二百七十，得一十六万三千，○八十，以初商自乗再乗隅因得五千减之，止存一十五。
万八千，○八十并上亷共二十四万八千八百，为下法。
又为添积开三乗方法
术曰：倍积自之，得二百六十二万四千四百为正，实四因截，积得三千二百四十为上亷 四因圆径。
得三百六十为下亷 五为负隅
初，商一十 ，置一于左上为法， 置一自之又自之，得一万为三乗方面以隅因之，得五万为益实，加入正实，得二百六十七万四千四百为通，实 置一乗上亷得三万二千四百 ，置一自之以乗下亷得三万六千，并上亷共六万八千四百，为下法，与上法相乗除实六十八万四千 ，余实一百九十九万，○四百未尽，为次商正实。
次商八 ，置一于左上为法， 置一加初商，自之又自之，得一十○万四千九百七十六，为三乗方面以隅法因之，得五十二万四千八百八十，内减初益实五万余四十七万四千八百八十为益实，加入次正实，共二百四十六万五千二百八十，为通实 ，倍初商加次商，得二十八以乗上亷得九万○七百二十倍，初，商加次商，得二十八，并初次商一十八相因。
加初商自乗共六百○，四以乗下亷得二十一万七千四百四十 ，并上亷共三十○万八千一百六十，与上法相乗除实尽。
圆径八十九歩从旁截积一千三百一十二歩半问截矢。
答曰矢二十五歩
不用倍积，术曰积自之，得一百七十二万二千六百五十六歩【二五】 截，积一千三百一十二歩半为上亷径八十九歩为下亷以一歩二分五厘为负隅，初商二十 ，置一于左上为法， 置一乗上亷得二万六千二百五十 ，置一以隅因之，得二十五以减下亷余六十四 ，置一自之以乗余下亷得二万五千六百，并上亷得五万一千八百五十为下法，与上法相乗除实一百，○三万七千 ，余实六十八万五千六百五十六歩二五未尽。
次商五 ，置一于左上为法， 置一以隅因之，得六歩二分五厘，以减余下亷余五十七歩七分五厘，倍初商，加次商得四十五以乗上亷得五万九千。
○六十二半， 倍初商，加次商并初，次商因之，得一千一百二十五，加初商自之四百共一千五百二十五以乗余下亷得八万八千，○六十八歩七五 内减初商自乗再乗隅因一万 ，止存七万八千，○六十八歩七五并上亷共一十三万七千一百三十一歩二五 与上法相乗除实尽。
解曰：弧矢，状类勾股，勾股得直方之半，故倍其积，以股除之，即得勾弧背曲，倍积则长一，而又一矢，以矢乗积倍之恰，得一一矢之数，因未知矢，故以积自乗为实约矢一度乗积以为上亷两度乗径以为下亷并之为法，而后可以得矢，用三乗者何也积本平方以积乗积是两度，平方矣，故用三乗方法开之，上亷下亷俱用四因者，何也？倍积则乗出之数为积者四，故上下亷俱四以就之，减径者何也？径乃圆之全径，矢乃截处之勾矢，本减径而得，故亦减径以求矢五，为负隅者，何也？凡平圆之积得平，方四之三，在内者七五，在外者二五，不拘圆之，大小毎方一尺，该虚隅二寸五分，四其矢，得四四其虚隅，得一合而为五，亦升实就法之意，如不倍积亷不用，四因以一二五为隅法亦通 ，或不减径作添，积三乗方法亦通。
圆径与截积求截
术曰倍积以矢除之减矢即
又法用矢径求术
圆径八十九歩从旁截积一千三百一十二歩半问截。
答曰八十歩
术曰倍积，得二千六百二十五歩以求出矢，二十五除之，得一百，○五歩乃一一矢，减矢即。
又曰：倍矢减径，余三十九自之，得一千五百二十一，为勾筭，全径自之，得七千九百二十一，为筭相减，余六千四百为股筭，平方开之。
若求弧背以径除矢筭即半背差
圆径与弧背求矢
术曰：半弧筭径，筭相乗为实径乗径筭为从方，径筭为上亷径背相乗为下亷以上亷减从以隅，减下亷三乗方法开之。
平圆径十尺从旁截处弧背八尺八寸问矢
答曰矢二尺
术曰：半弧背自之，得一十九尺三寸六分， 径自之，得一百尺， 相乗得一千九百三十六尺为正，实径乗径筭得一千尺，为从方 ，径筭一百尺为上亷全背乗径得八十八尺为下亷。
约商二尺 置一于左上为法 置一乗上亷得二百尺以减从方余八百尺 置一自之得四以减下亷余八十四尺 又以二乗余下亷得一百六十八尺 并从方共九百六十八尺为下法
又术商矢减，径存八尺，以矢乗之得十六，平方开之，即得半。
平圆径九十，歩旁截边弧背五十五歩八分问矢，答曰：九歩。
术曰：半背筭，七百七十八歩四一 径筭，八千一百二筭相乗得六百三十，○万五千一百二十一为正，实 径乗径筭得七十二万九千为从方， 径筭八千一百为上亷 径背相乗得五千○，二十二为下亷如前法求之。
平圆径九十歩旁截弧背七十九歩二分问矢
答曰矢一十八歩
术曰半弧筭一千五百六十八歩一六 径筭八千一百 二筭相乗得一千二百七十○万二千○九十六为正实 径乗径筭得七十二万九千为益从方 径筭八千一百为上亷 径背相乗得七千一百二十八为下亷
初，商一十 ，置一于左上为法， 置一乗上亷得八万一千以减从方，余六十四万八千 ，置一自之，得一百，以减下亷余七千○，二十八 ，置一乗余下亷得七万○二百八十，并减余从方共七十一万八千二百八十，为下法，与上法相乗除实七百一十八万二千八百余实，五百五十一万九千二百九十六未尽。
次商八 ，置一于左，次为上法 ，倍初商加次商，得二十八以乗上亷得二十二万六千八百，以减益从方，余五十○万二千二百为从，方 并初次商，得一十八自之，得三百二十四，加初商自之一百，为四百二十四，以减下亷余六千七百○，四 倍初商，加次商得二十八因之，得一十八万七千七百一十二，并入从方，共六十八万九千九百一十二，为下法，与上法相乗除实尽。
解曰：径除矢筭，得半背差，今以弧背求矢，故亦用半背筭与径，筭相乗为实，以径乗径筭为从，方而从方，内多一矢乗径筭之数，故以径筭为上亷以矢乗而减之，然从方得矢之方，而未得矢之亷也故又以全背与径相乗为下亷而下亷之中又多一矢自乗之数，故又约矢以减之，而以余数乗矢为下亷并从方以为法。
假如周天径一百二十一度七十五分二十五秒，【厯书中不用秒，故因之】。
黄赤道内外弧背二十四度 问矢度
答曰四度八十四分八十二秒
术曰：半弧背自之，得五百七十六度为半弧背筭，周天径自之，得一万四千八百二十三度，○六分二十五秒，为径筭 ，二筭相乗得八百五十三万八千，○八十四度为正，实 径乗径筭得一百八十，○万四千七百，○七度八十五分九十三秒七五，为益从方， 以径筭为上亷 倍半弧背，得四十八度以乗周径得五千八百四十四度为下亷。
初，商四度 ，置一于左上为法， 置一乗上亷得五万九千二百九十二度二十五分，以减益从方，余一百七十四万五千四百一十五度六十，○分九十三秒七五，置一自之，得一十六度，以减下亷余五千八百二十八度，又以四度因之，得二万三千三百一十二度，为从亷并从方共一百七十六万八千七百二十七度六十，○分九十三秒七五，为下法，与上法相乗除实七百，○七万四千九百一十，○度四十三分七十五秒。
余实一百四十六万三千一百七十三度五十六分二十五秒。
次商八十分 置一于左上为法， 置一倍，初，商共八度八十分以乗上亷得一十三万，○四百四十三度九十五分，以减益从方，余一百六十七万四千二百六十四度九十○分九十三秒七五，为从方 ，置一并初商自之，得二十三度，○四分，加初商自之一十六度，共三十九度，○四分，以减下亷余五千八百，○四度九十六，又以八度八十分因之，得五万一千，○八十三度六十四分八十秒，为从亷 并从方，共一百七十二万五千三百四十八度五十五分七十三秒七五，为下法，与上【阙】。
<子部,天文算法类,算书之属,弧矢算术,弧矢算术>
<子部,天文算法类,算书之属,弧矢算术,弧矢算术>
度九十九分一十八秒五二
七六，又以九度六十九分六十二秒乗之得五万六千二百，○八度七十九分，二十四秒，○二七三一五一二为从亷 并从方，共一百七十一万七千一百八十九度二十七分三十一秒六五二三一五一二为下法，与上法相乗除实三百四十三度四十三分七十八秒五四六三三○四六三○二四。
余实一百，○五度○九分五十五秒五三○○一七六九六九七六不勾一秒之数。
圆径与弧背求截
术曰求得矢用矢求术
圆径与弧背求截积
术曰求得矢用矢径求积
截积与截矢求截
术曰倍积减矢筭余如矢而一即
又曰倍积以矢除之减矢
圆不知径从旁截积二百八十三歩二分歩之一矢，阔九歩问截。
答曰截五十四歩
术曰倍积，得五百六十七，歩减矢筭八十一，余四百八十六，以矢除之，得五十四为。
圆不知径从旁截积八百一十步，矢阔一十八步，问截。
答曰截长七十二歩
术同
截积与截求截矢
术曰倍积以为从方平方开之
圆不知径从旁截积二百八十三歩二分歩之一截，长五十四步，问矢。
答曰九歩
术曰倍积得五百六十七为实 以五十四为从方约商九 置一于左上为法 置一带从得六十三为下法与上法相乗除实尽
圆不知径从旁截积八百一十歩长七十二歩问矢，答曰：矢一十八歩。
术曰：倍积得一千六百二十为实， 以七十二为从方。
初商一十 置一于左上为法 置一带从方共八十二为下法与上法相乗除实八百二十 余实八百 倍初商得二十带从方共九十二为方法次商八 置一于左上为法 置一带方法共一百为下法与上法相乗除实尽
截积与截矢求圆径
术曰：先求出，半之为筭，如矢而一，即矢径差，又曰：积自乗减矢自乗乗积余为实，矢自乗再乗为法除之，加虚隅即径。
圆不知径从旁截积六十二歩半矢五歩问径
术曰积自之，得三千九百，○六歩二五 矢自之乗积得一千五百六十二，步五相减，余二千三百四十三步，七五为实，矢自乗再乗得一百二十五为法，除之，得一十八步，七五矢乗虚隅一步二分五厘，得六步，二分五厘，加入即圆，径二十五。
截积与截求圆径
术曰先求得矢矢除半筭加矢即径
圆不知径从旁截积一千三百一十二步，半截，长八十步，问：圆径几何？
答曰圆径八十九步
术曰：先倍积，以为从，方平方开之，得矢二十五步，后用半自之，得一千六百步，以矢除之，得六十四为矢，径差加矢，即圆径。
截积与截矢求截弧背【求弧背同】
术曰先求得径以除矢筭得半背差
截矢与求圆径
术曰半自之如矢而一为矢径差
圆不知径从旁截一弧矢，阔九步，长五十四步，问圆径。
答曰圆径九十步
术曰：半自之，得七百二十九，以矢除之，得八十一为矢，径差加矢即径。
截矢与求截弧背
术曰先求得径以除矢筭为半背差
截矢与截求截积
术曰以矢加以乗矢得二积
截与外周求截矢【外周乃割残之周也】
术曰：筭半，筭相乗四而三之为实，并及残周乗半筭为益，方倍半，筭加筭，为从上亷并及残周为下亷以隅并上亷减从以余从并下亷为法三乗方法开之。
平圆旁，割一弧截处，五十四步外残，周二百一十四步，二分问，截矢几何？
答曰矢九步
术曰自之，得二千九百一十六，为筭 ，半自之，得七百二十九，为半筭， 二筭相乗得二百一十二万五千七百六十四，四而三之，得一百五十九万四千三百二十三为正，实 并残周共二百六十八步二分，以半筭乗之得一十九万五千五百一十七步，八分为益方 ，倍半筭，加全筭，得四千三百七十四，为从上亷 并残周得二百六十八步，二分为下亷一为隅法。
商得九 ，置一于左上为法， 置一乗上亷得三万九千三百六十六，为减亷 置一自之为八十一以乗下亷得二万一千七百二十四步，二分为益亷置一自乗再乗得七百二十九，为隅法并入减亷共四万○，○九十五 ，以减从方，余一十五万五千四百二十二步八分，并入下亷共一十七万七千一百四十七步，为下法。
圆田一段，西边被水浸入一弧，长二十步外，残周五十三步，问矢阔田，径田积。
答曰截矢阔五步圆径二十五步 弧背二十二步术曰如积求之得三万为正实 七千三百为益方六百为从上亷七十三为益下亷 一为正隅 三乗方开之得矢阔 矢除半筭加矢得径 倍矢筭以径除之得背差加即弧背 径自之四而三之得田积
圆田水浸一弧，长七十二步，外有残，周一百九十，○步八分，问矢阔。
答曰矢阔一十八步 弧背七十九步二分
圆径九十，歩 原田二十五畆，三分一厘，二毫五丝术曰：先求矢阔 ，筭五千一百八十四 半，筭一千二百九十六相乗得六百七十一万八千四百六十四步，四归三，因得五百，○三万八千八百四十八为正，实 并及残周共二百六十二步八分，以半筭乗之得三十四万，○五百八十八步八分，为益从方， 倍半筭，加全筭，得七千七百七十六，为减上亷 并残周二百六十二步，八分为益下亷。
初，商一十 ，置一于左上为法， 置一乗减上亷得七万七千七百六十，为减亷 置一自之以乗益下亷得二万六千二百八十，为益亷 置一自乗再乗得一千为减隅，并入减亷共七万八千七百六十为减，从之，算以减益方余二十六万一千八百二十八步，八分为从方，并益亷共二十八万八千一百○，八步八分，为下法 ，与上法相乗除实二百八十八万一千，○八十八 ，余实二百一十五万七千七百六十未尽。
二因减上亷得一十五万五千五百二十
三因益下亷得七万八千八百四十，为益亷之方，四因隅法，得四千为方法。
又以初商三之以乗益下亷得七千八百八十四，为益亷之亷 初商自之，六因得六百为隅上亷初商四之，得四十为隅下亷。
次商八 ，置一于左上为法， 置一乗初减上亷得六万二千二百，○八加入前，二因上亷得二十一万七千七百二十八，为减亷 置一乗益亷之亷得六万三千，○七十二步，并益亷之方共一十四万一千九百一十二，为益亷之筭 置一，自之以乗初益下亷得一万六千八百一十九步，二分并入益亷之筭共一十五万八千七百三十一步，二分为益亷 置一乗隅上亷得四千八百 ，置一自之以乗隅下亷得二千五百六十 ，置一自乗再乗得五百一十二，为隅法并方法，上下亷隅法共一万一千八百七十二，为减隅 ，并减亷共二十二万九千六百为减，从之，筭以减原，从余一十一万○九百八十八步八分，加益亷共二十六万九千七百二十，为下法，与上法相乗除实尽。
矢除半，筭得七十二为矢，径差加矢，即圆径倍矢筭，以圆径除之，得七步，二分为，背差加，即弧背 ，圆径自之，四而三得六千，○七十五步，以畆约之为畆。
解曰：求矢者，起于与径，今不知径而有残周，故以自乗半自乗相乗为实方中取圆，故四而三之，为三乗方实以，并残周与半，筭相乗为从方而从方之中，又多一筭，两半筭，及矢自乗再乗之数，故以全筭，与倍半，筭为上亷并求出矢自乗再乗之数以减之，却以并残周，为益下亷以求出矢，两度乗之并余从以为法，盖隅与上亷专主于减，从而下亷所以益从也。
筭为平，方以乗之为立方，又以半筭乗是为三乗方
正实五百，○三万八千八百四十八，乃三乘方数，内下亷该除一百五十三万二千六百四十九步，六分从方，该除三百五十，○万六千一百九十八步，四分从方三十四万，○五百八十八步八分，乃立方之数，内上亷减一十三万九千九百六十八隅，减五千八百三十二，止存一十九万四千七百八十八步八分，以矢十八因之以除实。
上亷减从除实用减从开平方法
从方带上亷一度矢乗之数共三十三万四千七百五十六步八分，以十八因之，该正实六百，○二万五千六百二十二步，四分欠二百五十一万九千四百二十四乃上亷减去之数。
初，商一十 ，置一为上法， 置一乗上亷得七万七千七百六十，以减从方，余二十五万六千九百九十六步，八分与上法相乗除实二百五十六万九千九百六十八，余实九十三万六千二百三十，○步四分， 倍上防，得一十五万五千五百二十为亷法。
次商八 置一为上法， 置一乗上亷得六万二千二百，○八并亷法共二十一万七千七百二十八，以减原，从余一十一万七千，○二十八步，八分为下法，与上法相乗除实尽。
从方假作平，方形长一十九万四千七百八十八步，八分濶一十八步，带十八，因上亷共长三十三万四千七百五十六步八分， 初商十步，十因上亷止除七万七千七百六十，少减六万二千二百，○八步，计多除正，实六十二万二千，○八十 ，次商濶八步，如从方原，长该除实，一百五十五万八千三百一十，○步八分，今止余实九十三万六千二百三十，○步四分，欠六十二万二千，○八十，正合初，商多除之，数 次商倍亷法多减七万七千七百六十，以八因之，其数适合，此自然之妙，凡用减从者俱如此。
隅减从用减从开三乗方法
隅立方，并从共二十，○万○六百二十，○步八分，以十八因该正实三百六十一万一千一百七十四步，四分欠一十○万四千九百七十六，乃隅减之数，初商一十 ，置一为上法， 置一自乗再乗得一千为方法，以减从方，余一十九万九千六百二十，○步八分，为下法，与上法相乗除实一百九十九万六千二百，○八步余实，一百五十，○万九千九百九十，○步四分 ，四因方法，得四千为方法， 初商自之，六因得六百为上亷初商四之，得四十为下亷次商八 置一为上法， 置一乗上亷得四千。
八百 ，置一自之以乗下亷得二千五百六十，置一自乗再乗得五百一十二，为隅法并方亷隅共一万一千八百七十二为减，从以减原，从余一十八万八千七百四十八步，八分为下法，与上法相乗除实尽。
初，商多存长四千八百三十二，濶十步，共四万八千三百二十，次商多，减六千，○四十，以八因之，相合下亷除实。
下亷二百六十二步八分，十八因之，得四千七百三十，○步四分为平方积，又十八，因得八万五千一百四十七步二分，为立方积，又十八，因得一百五十三万二千六百四十九步，六分为三乗方积。
初，商一十 ，置一为上法， 置一自之以乗下亷得二万六千二百八十，为下法，与上法相乗除实二十六万二千八百余实，一百二十六万九千八百四十九步，六分 三，因下法，得七万八千八百四十，为方法 ，三因初商以乗下亷得七千八百八十四为亷法 次商，八置一为上法， 置一乗亷法得六万三千，○七十二步，置一自之以乗下亷得一万六千八百一十九步，二分并方亷共一十五万八千七百三十一步二分，为下法除尽。
方圆术【附】
圆求容方
术曰：方径即圆径，若求圆积四，而三之不必立法，惟以圆求方，其法不一，姑録于此，盖径一，则围不止于三所，谓围三径一者，举其大较耳。
圆周五尺中容一斗斗方面几何
答曰斗靣一尺一寸六分六厘【三分厘之二】
术曰七因周得三尺五寸以三归之
此术载呉，信民筭法，以周为，以方为股，然七因五尺为三十五，未是。
圆材径二尺一寸为方靣几何
答曰方径一尺四寸五十八分寸之四十九
术曰：径为股自之，得四百四十一寸折半，平方开之，又曰：三因径得六尺三寸七分，因之三归，得方靣一尺四寸一十分寸之七。
圆径十尺问容方面几何
答曰容方面七尺
术曰：三其径，得三十尺，以七寸因之，得二十一尺三归，得七尺，方圆之术，径一，则围三有竒方五则斜七有竒难以一定之法例之，【径自之，折半，平方开之，多一筭】。
圆径折变
圆周求径
古法围三径一 ，徽术周一百五十七，径五十宻术周二十二，径七。
周八十四问径
古术答曰二十八
术用三归
徽答曰：二十六步，【一百五十七分，步之一百一十八】术曰：周五十因如一百五十七而一。
宻答曰二十六步【一十一分步之八】
术曰周七因如二十二而一
周八十七【二十五分步之二十三】问径
古术答曰二十九步【七十五分步之二十三】
术曰：分母通其全，分子从之，得二千一百九十八为实，三因分母得七十五为法。
徽答曰二十八步
术曰：分母通其全，分子从之，以五十因之，得一十○万九千九百为实， 一百五十七，因分母得三千九百二十五为法。
宻答曰：二十七步，【二百七十五分步之二百六十八】术曰：分母乗其全分子从之，七因得一万五千三百八十六，置分母以二十二因得五百五十，为法不尽者，法实俱半约之。
假如厯法周天三百六十五度二十五分七十五秒，问周天径几何？
答曰一百二十一度七十五分二十五秒
此以围三径一求之
以徽术求之为径几何
答曰：径一百一十六度三十二分四十秒，【一百五十七分秒之七】。
术曰：五十因周得一万八千二百六十二度八十七分五十秒，以一百五十七除之。
以宻术求之为径几何
答曰：一百一十六度二十一分八十二秒，【二十二分秒之，二十一】。
术曰：七因周得二千五百五十六度八十○分二十五秒，以二十二除之。
圆径求周
圆径二十八问周
古法答曰八十四
术用三因
徽答曰八十七步【二十五分步之二十三】
术曰：径一百五十七，因得四千三百九十六，如五十而一。
宻答曰八十八步
术曰径二十二因如七而一
圆径二十六步，【一百五十七分，步之一百一十八，】问周古法，答曰：八十步，【一百五十七分，步之四十】。
术曰：分母通其全，分子从之，三因得一万二千六百为实，如分母而一。
徽答曰八十四步
术曰：分母通其全，分子从之，又一百五十七，因得六十五万九千四百为实， 分母五十，因得七千八百五十为法。
又曰：分母通其全，分子从之，得四千二百，如五十而一。
宻答曰：八十四步，【一百五十七分，步之一十二】术曰：分母通其全，分子从之，又二十二，因得九万二千四百为实， 七，因分母得一千，○九十九为法。
圆径二十六歩【一十一分步之八】问周
古法答曰八十步【一十一分步之二】
术曰：分母通其全，分子从之，得二百九十四，又三因得八百八十二为实，如分母而一。
徽答曰：八十三步，【二百七十五分步之二百五十四】术曰：分母通其全，分子从之，又一百五十七，因得四万六千一百五十八为实 ，五十，因分母得五百五十，为法。
宻答曰八十四步
术曰：分母通其全，分子从之，又二十二，因得六千四百六十八为实 ，七因分母得七十七为法。
又曰：分母通其全，分子从之，倍之，得五百八十八，如七而一。
圆周求积
周八十四问积
古术答曰五百八十八步
术曰：周自之得七千，○五十六如圆法，十二而一徽，答曰：五百六十一步，【一百五十七分，步之一百二十三】术曰：周自之又二十五，因得一十七万六千四百为实，如三百一十四而一。
宻答曰五百六十一步【一十一分步之三】
术曰：周自之七，因得四万九千三百九十二为实，如八十八而一。
圆周八十七步【二十五分步之二十三】问积
古法答曰：六百四十四步，【一千八百七十五分，步之三百，○一】术曰：分母通其全，分子从之，得二千一百九十八自之，得四百八十三万一千二百，○四为实 ，分母自之，得六百二十五，又十二因得七千五百为法，徽答曰：六百一十五步，【二十五分步之一十一】术曰：分母通其全，分子从之，自乗又以二十五乗之得一亿二千，○七十八万，○一百为实 ，分母自乗又以三百一十四乗之得一十九万六千二百五十为法，除之不尽，八万六千三百五十法，实皆七千八百五十约之。
宻答曰：六百一十四步，【一万三千七百五十分，步之一万二千一百，○七】术曰：分母通其全，分子从之，自乗又七因得三千三百八十一万八千四百二十八为实 ，分母自乗又八十八，因得五万五千为法，除之不尽，四万八千四百二十八法，实皆四约之。
周八十八步问积
古法答曰六百四十五步【三分步之一】
术曰周自之，得七千七百四十四，如十二而一徽，答曰：六百一十六步，【一百五十七分，步之八十八】术曰：周自乗二十五因，得一十九万三千六百为实，如三百一十四而一。
宻答曰六百一十六步
术曰：周自之七，因得五万四千二百，○八为实，如八十八而一。
圆径求积
圆径二十八步问积
古术答曰五百八十八步
术曰径自乗四归三因
徽答曰：六百一十五步，【二十五分步之一十一】术曰：径自乗以七十八步，半因之，得六万一千五百四十四，如百而一。
宻答曰六百一十六步
术曰：径自乗一十一因得八千六百二十四，如一十四而一。
圆径二十六步，【一百五十七分，步之一百一十八，】问积古法，答曰：五百三十六步，【二万四千六百四十九分，步之一万八千一百三十六】术曰：分母通其全，分子从之，自乗四归三因得一千三百二十三万为实，分母自之，得二万四千六百四十九为法。
徽答曰：五百六十一步，【二万四千六百四十九分，步之一万九千三百一十一，】术曰：分母通其全，加分子自乗又以七十八步半乗之得一十三亿八千四百七十四万为实 ，分母自乗百因得二百四十六万四千九百为法。
宻答曰：五百六十二步，【二万四千六百四十九分，步之七千二百六十二】术曰：分母通其全，加分子自乗得数又以一十一因之，得一亿九千四百，○四万为实。
分母相乗又十四因之，得三十四万五千，○八十六为法除之，未尽一十，○万一千六百六十八法，实皆一十四约之。
圆径二十六步【一十一分步之八】问积
古法答曰：五百三十五步，【一百二十一分，步之九十二，】术曰：分母通其全，加分子自乗得数四而三之，得六万四千八百二十七为实。
分母相乗为法
徽答曰：五百六十步，【六千，○五十分，步之四千六百一十三，】术曰：分母乗其全加分子自乗又以一百五十七乗之得一千三百五十七万，○四百五十二为实， 分母自乗二百因之，得二万四千二百为法。
宻答曰五百六十一步【一十一分步之三】
术曰：分母通其全，加分子自乗又一十一因之得九十五万，○七百九十六为实 ，分母自之，又十四因之，得一千六百九十四为法。
圆积求周
圆积五百八十八步问周
古法答曰周八十四步
术曰十二因积平方开之
徽答曰：八十五步，【一万七千一百分，步之一万六千五百二十八，】术曰：积三百一十四，因得一十八万四千六百三十二，以二十五除之，得七千三百八十五步，二八，平方开之。
宻答曰八十五步，【一百七十一分，步之一百六十七，】术曰：积八十八，因得五万一千七百四十四，七除之，得七千三百九十二，平方开之。
平方还原，方自乗以分母乗之得一百二十三万五千四百七十五 ，分母子相乗得二万八千五百五十七，为益实，并得一百二十六万四千○，三十二为实，分母为法除之，还原。
圆积六百一十六步问周
古法答曰：周八十五步，【一百七十一分，步之一百六十七，】术曰：十二因积得七千三百九十二为实，平方开之，徽答曰：八十七步，【一万七千五百分，步之一万六千七百九十六，】术曰：积三百一十四，因得一十九万三千四百二十四，以二十五除之，得七千七百三十六步，九六，平方开之，不尽者，以百因约之。
宻答曰八十八步
术曰：积八十八，因得五万四千二百○，八以七除之，得七千七百四十四，平方开之。
圆积五百六十一步，【一百五十七分，步之一百二十三，】问周几何，古法？答曰：周八十二步，【二万五千九百，○五分步之二千七百三十二，】术曰：分母乗其全加分，子得八万八千二百，以圆法十二因之，得一百，○五万八千四百为实， 以一百五十七，为隅法作从隅，开平方法除之。
初，商八十 置一于左上为法， 置一乗从隅得一万二千五百六十为隅，法与上法相乗除实一百，○○万四千八百余，五万三千六百未尽 ，倍隅法，得二万五千一百二十为亷法 约次商二 ，置一于左，次为上法， 置一乗从隅得三百一十四，并入亷法共二万五千四百三十四，为下法，与上法相乗除实五万，○八百六十八 ，尚余二千七百三十二，倍八十二，加一筭，以分母乗之为母约之。
又术分母通其全，加分子十二因之，得一百，○五万八千四百，又以母乗之得一亿六千六百一十六万八千八百，平方开之，得一万二千八百九十 ，余实一万六千七百未尽，另寄 将开出之数，以分母约之，得八十二 ，仍未尽一十六，以分母乗之得二千五百一十二，加入寄位，共一万九千二百一十二为不尽之数， 倍八十二，加一筭，得一百六十五，以分母乗之得二万五千九百，○五。
徽答曰八十四步
术曰：分母通其全，加分子得八万八千二百，以三百一十四，因得二千七百六十九万四千八百，以二十五，因分母得三千九百二十五为法，除之，得七千，○五十六，平方开之。
宻答曰：八十四步，【二千，○四十一分，步之一百，○八】术曰：分母通其全，加分子得八万八千二百，又八十八，因得七百七十六万一千六百 ，七因分母作一千，○九十九除之，得七千，○六十二 ，余实四百六十二未尽。
置七千，○六十二，平方开之，得八十四 ，余六未尽，以分母通之，得九百四十二，加前未尽共一千四百○，四倍八十四加一筭，得一百六十九，以分母乗之得二万六千五百三十三，是谓二万六千五百三十三分步之一千四百，○四 法，实皆十三约之，得二千，○四十一分，步之一百，○八。
积四十五步，【一十一分步之九，】爲宻圆周几何？
答曰二十四步
术曰：分母乗其全加分，子得五百○，四以八十八因之，得四万四千三百五十二以七，因分母为七十七除，得五百七十六，平方开之。
右四元玉鉴所载不用从隅
圆积求径
圆积五百八十八步问径
古法答曰二十八步
积三归四因平方开之
徽答曰：二十七步，【八千六百三十五分步之三千一百四十七】术曰：积百，因得五万八千八百，以七十八步，半为从隅，平方开之， 初商二十，置一于左上为法，置一乗从隅得一千五百七十，为隅法与上法相乗除实三万一千四百余实，二万七千四百未尽 ，倍隅法，得三千一百四十为亷法 约次商七 ，置一于左，次为上法， 置一乗从隅得五百四十九步，半并亷法共三千六百八十九步，半为下法，与上法相乗除实二万五千八百二十六步，半 余实一千五百七十三步，半 倍，二十七加一筭，得五十五以七十八步，半因之，得四千三百一十七步半法，实皆倍命之宻，答曰：二十七步，【六百，○五分步之二百一十三】术曰：积一十四，因得八千二百三十二，以一十一为从隅，平方开之， 初商二十 ，置一于左上为法，置一乗从隅得二百二十，为隅法与上法相乗除实四千四百余实，三千八百三十二 倍隅法，得四百四十为亷法 约次商七 ，置一于左，次为上法，置一乗从隅得七十七为隅，法 并亷隅共五百一十七，为下法，与上法相乗除实三千六百一十九，余实二百一十三未尽，如前法约之。
积六百一十五步，【二十五分步之一十一】问径。
古法答曰：二十八步，【四千二百七十五分步之二千七百四十四，】术曰：分母乗其全加分，子得一万五千三百八十六，以四因之，得六万一千五百四十四分，母三之为七十五，为从隅，平方开之余，实二千七百四十四倍，开出之数加一算，得五十七，以从隅因之，得四千二百七十五，为母约之。
徽答曰二十八步
术曰：以积分母除分，子得四分四厘，加全步得六百一十五步，四分四厘百之，得六万一千五百四十四为正，实以七十八步五分为从隅，平方开之。
宻答曰：二十七步，【一万五千一百二十五分步之一万四千九百二十九，】术曰：置积以分母通之，加分子得一万五千三百八十六，以一十四因之，得二十一万五千四百，○四为正，实以二百七十五为从隅，平方开之 ，余实一万四千九百二十九 ，倍径加一算，以从隅乗之为分母约之。
平圆积四十五步，【一十一分步之九，】问宻圆径几何？答曰：七步【一十一分步之七】。
术曰：分母乗其全加分子以一十四乗之得七千，○五十六，平方开之，得八十四，以一十一除之不尽七，还原法曰：分母乗七加分子自之，又一十一，因得七万七千六百一十六为实 ，分母自之，又一十四，因得一千六百九十四，为法 除之，得四十五，余一千三百八十六，法实皆一百五十四约之，还原数。
黄钟算附
假如黄钟之管空容九分问围圆几何
答曰：围圆一十，○分三厘，【二百，○七分厘之，一百九十一】，此以围三径一，求之十二，因积得一百○八，平方开之，以徽术推之，得几。
答曰：围一十，○分七厘，【二百一十五分，厘之五十五】术曰：积三百一十四，因得二千八百二十六，以二十五除之，得一百一十三○，四平方开之。
以宻术推之得几
答曰：围一十，○分【一百四十七分分之九十二，】术曰：积八十八，因得七百九十二，如七而一，得一百一十三【七分之一，】平方开之，不尽一十三，以七因加一为子，倍十分加一，七因为母命之。
黄钟之管空容九分问径
答曰：径三分四厘六毫，【六百九十三分毫之二百八十四】，此用三归，四因平方开之。
以徽术求之
答曰：径三分三厘八毫，【五十三万一千四百四十五分毫之三万一千八百四十六，】术曰：百因积得九百分，以七十八分半为从隅，平方法开之， 初商三分 置一于左上为法， 置一乗从隅得二百三十五分五厘，为下法，与上法相乗除实七百，○六分半，余实一百九十三分半，倍隅法得六分，为防法 ，次商三厘， 置一于左上为法， 置一并亷法共六十三厘以乗从隅得四千九百四十五厘五毫；与上法相乗除实一百四十八分三厘六毫五丝，余实四十五分一厘三毫，五丝 倍初，次商得六分六厘，为亷法三商八毫， 置一于左上为法，置一并亷法共六分六厘八毫以乗从隅得五百。
二十四分三厘八毫，与上法相乗除实四十一分九厘五毫；○四忽余实，三分一厘八毫，四丝六忽 倍，商加一算，以从隅乗之为分母命之。
以宻术求之得径几
答曰：径三分三厘，【七百三十七分，厘之六百二十一，】术曰：一十四，因积得一百二十六，以一十一为从隅，平方开之， 初商三分 置一于左上为法， 置一乗从隅得三十三分，与上法相乗除实九十九分，余实二十七分， 倍下法，得六分为亷法 次商三厘，置一为上法， 置一并亷法乗从隅得六百九十。
三厘与上法相乗除实二十，○分七厘九毫，余实六分二厘一毫 倍，商加一算，以从隅因之，得七百三十七为分，母命之。
还，原曰：径相乗得一十○分八厘九毫以一十一，因得一百一十九分七厘九毫加不尽，四分二厘一毫得原数。
黄钟之大小，不系于此，但假此以明数之防妙耳，尝观儒者之论律管徃徃泥于数而不察，夫理假如黄钟之实，乃十一度，三因以起十一律之数律管，以三分为损益，故十一度三之，非实有数也。实乃算法中之实耳，虽蔡九峯，亦谓仲吕之实数，不可三，其数不行，此律之所以止于十二也。殊不知五音六律，乃天地隂阳自然之理，圣人因之制管，以宣其声，而又三分损益以定其管之长短，使其无相夺伦，顾乃以数为造律之本，岂不谬哉！
律管算附律管以三分损益故止立二三四乗除之法二一如二  二二如四  二三如六
二四如八  二五作一一 二六作一三
二七作一五 二八作一七 二九作二
三一如三  三二如六  三三作一
三四作一三 三五作一六 三六作二
三七作二三 三八作二六 三九作三
四一如四  四二如八  四三作一三
四四作一七 四五作二二 四六作二六
四七作三一 四八作三五 四九作四 右因二归逢一作四一逢二进一
三归逢一作三 逢二作六  逢三进一
四归逢一作二一逢二作四二 逢三作六三
逢四进一           右归
黄钟管长九寸           三归二因
林钟管长六寸           三归四因
太簇管长八寸           三归二因
南吕管长五寸三分         三归四因
姑洗管长七寸一分         三归二因
应钟管长四寸六分六厘       三归四因
防賔管长六寸二分八厘       三归四因
大吕管长八寸三分七厘六毫     三归二因
夷则管长五寸五分五厘一毫  ，   三归，四因夹钟管长七寸四分三厘七毫，三丝  ， 三归，二因无射，管长四寸八分八厘四毫八丝，   三归，四因仲吕，管长六寸五分八厘三毫，四丝六忽。
右术止用九寸，损益以定十一律管不必用十一度，三因若求变黄钟，就以仲吕之管三归，四因即是，不必更用七百二十九乗之数。
弧矢算术