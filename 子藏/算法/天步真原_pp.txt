钦定四库全书     子部
天步真原       天文算法类【推步之属】提要
【臣】等谨案天步真原一卷
国朝薛凤祚所译西洋穆，尼阁法也，凤祚有两河清，彚已着録顺治中穆尼阁，寄寓江寕，喜与人谈算术而不招人入耶？苏教在彼，教中号为笃实，君子凤祚，初从魏文魁防主持旧法，后见穆尼阁，始改从西学，尽传其术，因译其所说，为此书其法，専推日月交食，中间绘弧，三角图三，一则有北极出地有日，距赤道有时刻，而求高弧，一则有日距天顶，有正午黄道，有黄道与子午圏相交之角而求黄道高弧交角，一则有黄道高弧，交角有高下差而求东，西；南，北二差末，绘日食，食分一图，凤祚译，是书时新法初行，又中西文字，辗转相通，故词防未能尽畅，梅文鼎尝订证其书，称其法与，崇祯新法厯书有同有异，其似异而同者，布算之同，对数之表，与厯书逈别然，得数无二，惟黄道，春分二差，则根数大异，非测候，无以断其是非，然其书在未修数，理精蕴之，前録而存之，犹可以见，步天之术，由疏入宻之渐也，乾隆四十七年十月恭校上。
总纂官，【臣】纪昀，【臣】陆锡熊，【臣】孙，士毅。
总 校 官 【臣】 陆 费 墀
钦定四库全书
天步真原
青州薛凤祚撰
日食原理
日月泛遇为平防日月，地心在一线为正，会日月，人目在一线为实，防用东西南北差为视会。
求食限
中华定食限，取北中界【，地居赤道之北，南不至赤道北，不至北极，】日食，依南方北极出地十八度，北方，北极出地四十二度，定食限最广者，太阴距南，交尝度七度三十一分，午时高下差全，变为南北差，以加二径折半，故距度少，太阴距北交，尝度一十七度三十五分午时高下差全，变为南北差，以减二径，折半故距度多为可食之限，最狭者太阴，距南交尝七度，距北交尝一十六度五十三分，为必食之，限 月食不论，阴阳厯其限皆一十五度一十二分，在日之冲。
日月交入食限算朔在昼分望在夜分即有食
日月越，六月皆能再食，若五月能再食则，大月七月能再食则，小月。
年月积日
根数起汉，庚辰，至崇祯厯元后二十三年庚寅积一千六百五十年，入厯减一算。
先求年变日表次月变日表搃计得第三旬周数 第二旬周数 第一旬周数 日数
大西东来，应加【一日，】日数末，一日未成，应减二算对，仍依原数。
平朔中积
月距日平行表搃计，各旬周及日数，平行度分，以减全周得全，周余度，又以距日平行表，取近小度数，求日时分，并加于旬周，日数为平朔中积日分。
如先得本年月朔望，防只以朔望防逓加平朔，免积日之烦，望防一十四日十八，小时二十二分○二秒，朔防倍之，二十九日，一十二，小时四十四分○四秒。
以中积入表求时分
以中积入，表求春分，平行，即以春分平行为引数，求加减。
以中积入表求日平行
以中积入表求日，心平行，即以心行为引数，求心差加减及比例分。
以中积入，表求高行以上叚所得，心差加减之，为真高行。
以日平行减直高为实引
以实引入表求日初均及余分
以比例及余分求次均度
以初均次均度，加减日平行为实经，又加减春分为日，自春分实经。
以中积入表求月距日度分两倍之，即月心平行，以月心行入表求心，行加减及比例分。
以月自行加减心差为月实引
以月实引入表求月初均度及余分
以比例余分求次均
以日平行并月距日行得月平行，以加减初次均为月实，经又加减春分差为月，自春分实经。
求平防离正防度分 日月相距弧
太阳均度，与太阴均度，若一加一减，二均度相加，得平防离正防度分，若俱加或俱减，以小减大，其余数即平防离正防度分。
求日月相距时刻
以太阴实引数入表取月一时行度分，【若无正度，用比例法，】以上叚平防离正防度分，用三率法当行，几时刻为日月，相距时刻。
日月在前在后
日月均度，或俱加加大者在前，或俱减减，小者在前，若加减不同，即减者在前。
月在日前，平防比实防先到日在月前，平防比实防后到。
相距时刻加减
平防先到日月相距时刻加实，防先到日月相距时刻减，以加减平朔中积日分变时，分为正防，时刻试法真否。
以正防时刻再筭积日
时分变日分
日春分平行及加减
日平行
日心之平行及加减及比例
日高行及真高行
日实引数
日加减度及余分
日次均
日实经及自春分实经
月距日平行及心行
月心差及比例分
月平引及实引
月加减均度及余分
月次均
月平行实经及自春分实经
时分变日以下，十六法皆同前，惟月距日平行筭于太阳，实经之后，与上法异。
前后二筭，太阳距太阴度差，在三十秒，以下即可用，若差多再筭。
再筭法
太阴实引数取月一时行用三率法 一率月一时行分 二率一时 三率太阴距太阳差分 第四得所求时分
太阳在太阴前，实防先到所得时，减太阴在太阳，前平防先到所得时加。
筭诸行俱同前
应时
以太阳实经度，查黄赤道变度表，得赤道度，【无正度，用比例法，】太阳平行减黄道根数四，周纪三十八度三十六分三十四秒，平行小加一，圏减其余，为黄道余度。
变赤道度，减赤道根数二百八十度三十五分赤道小加一圏，减其余为赤道余度。
黄赤道二，余度相减，变时分【，黄道余度大时分，加正防赤道余度大时，分加正防，】南京，比立表之地，又加七时，二十八分，北京又加二十○，分为实防，应时【以上，定朔】。
求太阳实防经纬度
太阳黄道实经度变赤道即距赤道实经度
太阳黄道实经度，用表查纬度南北度分，即太阳距赤道纬度。
求太阳距天顶度【前后三时同用】
月在日，前月加减大，日加减小平，防先到实防后到，自应时自午，而己辰向后，筭三小时，若月加减，小日加减，大月在日后，平防后到实防，先到自应时，自午而未申向前，筭三小时。
筭丁亥甲大三角
有亥甲，邉北极出地之余 ，有亥丁，邉日过白羊初度，纬在赤道北，以日距赤道纬度减九十度，若日过天枰初度，纬在赤道南，以日距赤道纬度加九十度，有亥，角距午时刻，每时作十五度，午后加赤道实。
经度午前减
从不知之角打线从丁从甲皆可
今从丁打线至巳先求亥巳线
若大于亥丁分线在外小于亥
丁分线在内
先筭亥巳甲三角
用圏线正角第三法有两角一邉，其先有邉为正角对邉法。
求亥巳，邉【先有角相连之邉，有巳正角 ，有亥角距午度分， 有亥甲邉，北极出地之余为正角对邉】。
一率通   二率亥角余线  三率亥甲邉切线四率得亥巳邉切线
求甲巳邉【先有角相连之邉 有巳正角 有求邉对亥角 有亥甲邉 此为正法今用捷法省此筭】
一率通   二率亥角正线  三率亥甲邉正线四率得甲己邉正线
又筭甲己，丁三角，【有己正角 ，有甲己，邉有己丁邉】。
求己丁，邉日距赤道纬度减九十度，或加九十度，除上所得亥巳，邉即己丁邉。
求甲丁邉
一率通  二率甲己邉余线   三率己丁邉余线  四率得甲丁邉余线为日距天顶度其余即距地平
筭前后三小时同法，但时在午前，以距午前分数减六十分，所得求度分，有时者，每一时加十五度，时在午后，以距午后分数，求度分有时者，每一时加十五度，为距午时。
有捷法省求甲己邉径求甲丁邉
一率亥巳邉余线  二率亥甲邉余线  三率己丁邉余线  四率即径得甲丁邉余线距天顶度【余距地平】
筭差角【前后三时同用】
如图丑甲午为差角然丑甲邉难
取而甲己丙角与甲午之大小同
故寜算丙甲己钝用
筭丙己邉
离午时【，即前图亥角，每时十五度】看在午前，后在午后【，自午而未申，】加太阳，实经变赤道度，【即应时所得，】在午前，【自午而巳辰，】减太阳实经变赤道度为过，午时圏度，即知入何宫度，【如得二百五十一度五十分，】即入天，蝎一十一度五十分。
变黄道以表中赤道对黄道度数取黄道度
有黄道度即可入，表求黄道纬度又看，黄纬在赤道南，北在赤道北，【自白羊初至，双女三十度，】以纬度减，北极出地所得，在赤道南，【自天枰初至，双鱼三十度，】以纬度加，北极出地度，所得为丙己邉。
筭己角
丙己，邉内有赤道过午时，圏度【离午时，加实经所得，】有赤道变黄道度，此入表不用，过午时圏度，用变黄道度，求交角，表有余分，则用比例，法得己角。
筭甲角【即差角】
一率丙甲邉距天顶正线   二率己角正线  三率丙己邉正线
搃数相较即得甲角正线为差角
求地平差【此法或前或后三时同用】
东西南北差之本，是高卑差高卑差之本，是地平差。
以太隂实引数入表，得其相对之分秒，有余数以下，度与余数比例，或加或减于相对之数为太隂地平差崇祯厯书作地平径数。
求太隂高卑差【此法或前或后俱筭三时】
查表以所得地平差分数，从上以前，得距地平，【即距天顶减九十度之余，】从右小余，另比例为先得太隂高卑差。
太阳高卑，差以距地，平查表得分秒，以减先得太隂高卑差为太隂真高卑差【，恒减不加】。
如图
日月在甲人目在地视之不见在
甲而见在丁甲丙为日高即甲
丁为高卑差
就黄道极作一大圏至高卑，差丁相交，黄道又交过顶圏。
戊为正角，凡各圏过，本圏之极，其相交之角，即正角甲丁为高差，日在甲人目视之，不见在甲而见在，戊即甲戊为东西差，戊丁为南北差。
高卑差南，北差东西差三者，惟甲丁高卑，差至大不过六十分，其甲戊东西差戊丁，南北差皆小于甲，丁高卑差，故皆锐角，又且分数少在天，俱可作直线，筭东西差，【前后三时同法】。
以通【，一○○○，○】为一率， 以前得差角，【即甲角余线，】为二率，三率以高卑差分秒，俱化成秒，求其对，数与二率相加去，一率通求原，数以六十成分，为东西差筭，南北差【，前后三时同法】。
以通【，一○○○，○】为一率， 以前得差角，【即甲角正线，】为二率，三率以高卑差分秒，俱化成秒，求对，数与二率数相加去，通求原，数以六十成分，为南北差。
若查表第一行，距天顶数第二行，东西差邉，第三行，南北差邉，省用前筭三角法。
如筭东西差 一率六十分 二率取表中第二行东西差邉 三率前取太隂高卑差 即得所用东西差 南北差同法但取表中第三行
表中各宫皆初分，用法如午时，正二刻六分，日在天蝎一度四十六分，○八秒， 如天蝎一分午时得距天顶四十二度三十五分，人马一分，午时得距天顶五十一度二十一分，其差八度四十六分，用下法。
一率一宫三十度 二率八度四十六分 三率天蝎一度四十六分○八秒
搃数较数，即其差分，以加先得四十二度三十五分，即天蝎一度四十六分，距天顶度。
东西南北差同法
求视防【筭日食月行】
以太隂实引数入表，其表每隔三度，以余分求比例，或加或减，于正度之，上为太隂一时分实行度。
有实行取视行
第一法，月食在黄道九十度，限东东西差，先大后小，【早间食辰时在先，巳时在后，午后食，未时在先，申时在后】，其上所筭第一，时东西差与第二时东西差第三时东西差与第二时东西差相减，其余分与实行相减，为视行。
若东西差先小后大，其前后二差相减，其余分加实行，为视行。
第二法，日食在黄道九十度，西东西差先大后小，其东西差，前后二差相减，其余分加实行，为视行。
若先小后大，其东西差，前后二差相减，其余分减实行，即为视行。
第三法，一半在九十度，限东一半，在九十度，西前后二东西差相减，【不论先后，大小】，其余与实行相减，余分即为视行。
视行距度
东西差大，实行小以实行，减东西差，其余为实，防与视防相距度分东西差小，实行大即以东西差为实防，距视防度分。
视防相去度变时法
第一法，若实防东西差，比视行小，其东西差分数，要实防相近，时视行比例，分得实，防与视防相去度数变时分。
第二法若实，防东西差，比视行大除，一时月视行，余东西差分数，要视防相近，时视行比例，分得实，防与视防相去度数变时，分 二叚，日食在东，皆减实防，时分为视防，时分在西，皆加实防，时分为视防，时分。
一率太隂实行  二率六十分  三率实防去视防度分俱化为秒乘除成分为所变时分
用第一法加减实防为视防
用第二法一时之外加减实防为视防
试法真不真
用所得视防再筭距天顶 再筭差角 地平差同前数 再筭太隂高平差 再筭东西差 再筭南北差 日食月行同前数
有实行求视行
以所得东西差置位 一率六十分 二率月一时实行 三率上叚所得有实行求视防变时分 俱化为秒 乘除 成分 与置位东西差相减余为差分
有差分变时分
一率上叚实防距视防度分  二率上叚实防距视防所变时分   三率差分   俱化为秒  乘  除  成  分  秒
为变时
差分大东西差小，上叚视防，时分内当减变时，分为视防差分，以加减实防为视防。
差分小东西差大，上叚视防时分内，当加变时，分为视防差分，以加减实防为视防。
时分差至三十秒，内即定，视防若多，又用三试其筭，法与第二叚试法同，但要所得差分成时，与东西差合方定，视防。
求日食大小筭交行
以日月实防时分，【用应时定数，】入平距度，表搃计交行度以太隂均度依号加减之，为实防交行，以加减东西差为日月，视防交行度，实防在前东西差减实防，若在后东西差加。
求距度
以交行宫度分秒，查距度表有小余，用比例法，为视防距度，又本表后行，余分比例，下度差分为正，余分与太隂心差比例，分相较乘除，以加距度为真距度，【恒加不减】日，月食，若无此比例，分及余分者，省此筭。
距度【○一二宫北下 六七八宫南上三四五宫南下 九十土宫北上】
求视距度
正交防在南，在北，与南北差，同类相加，异类相减，【北极出地二十三度三十一分以上皆在南】，为视距度。
若南北差大于距度，其日食交在北者移而南，求日月半径。
以太阳实引数入表求日半径
以太隂实引数入表求月半径
以两半径搃数减视距度余数为食分，距度若距度，大于两半径，搃数即无食。
食分
以太阳全径为一率 ，日月两半径搃数减视距度为二率，西法十二分为三率。
取第四即西法日食分
又作中国分以西法十二分为一率 以所得西法日食分为二率 中法日食十分为三率 取第四即中法日食分
用表以日全径从右以距度分，从上再以日全径小余，从右以距度分，从上得食分。
求初亏
以食甚前一，时东西差与食甚，时东西差相较，余数以加减月实，引数所得月一时，正行为食甚前，一时视行 取法，与前有实行，求视行同法。
用表以日月半径搃，数从上以真距交度分从右，又以半径搃数小余，从上以距交从右，共得○分秒，以太隂食甚前一时，视行为一率，以一时六十分为二率，以表上所取分秒，为三率 ，乘 除 成，分得时分，以减食甚时刻，为初亏。
求复圆
依法再求食甚后一小时距顶 距地平 差角 高差 东西差
以食甚后一时与食甚东西差相较，余数以加减月实，引所得月一时，正行为食，甚后一时视行。
用表同初亏法以加食甚时分为复圆
丑卯黄道 未寅白道
丑未寅卯为距交
子辰为太阳半径
午申为月半径
子丙为日月两半径搃数
月食原理
月食，求积年日数筭，太阳诸行太隂诸行皆与筭日食，同求日月前后日月相距度相距时刻，筭日月实，防皆与日食同。
再筭试真否皆与日食同
求太隂正中交行
置实防中积日数分，秒入太隂平距度表搃，计交行度数加减太隂均度得交平行。
求太隂距交分【余分，有比例分取用，无比例，分省笔】。
以太隂平交行入距交度，表得距交分，无正度分，用比例法。
初一二九十十一宫北
三四五六七八宫南
求太隂半径及全径
以太隂实引数入，表得太隂半径无正度，用比例法，倍之为太隂全径。
求地景半径
以太隂实引数入表，得地景径，【无正度，用比例法，】减对行秒，余为真半径。
两半径减距交余数
月半径加地，景半径并之，以所得距交分数减之，所得为二，径余数。
食分
日月食表，月全径从右二径余，数从上得月食分，月食，有初亏食既，食甚生光复圆五叚，若在十二分以内食不全，及全食，即生光者，去食甚，生光二叚，西法月作十二分，筭 中法，月食作十五分。
如西法筭月食十八分一秒 一率十二分 二率十八分 三率十○分 得中法十五分
食既分食甚分
月食不全，或全食而食尽，即生光者，所得为食既分，若月全食，食后不即生光者，所得为食甚分。
食时分表，以月半径地，景径并之搃，数从上月交距度，从右无正度，用比例法为食，既与食甚度分。
初亏分
实防减食既与食甚分为初亏分
有食甚求食既分【月食不全不必再筭】
以月半径减地，景半径从上月交距度，从右【无正度，用比例法】，以减食甚分，为食既分。
生光
以前所得有食甚求食既分数加食甚为生光分
复圆
实防并食既与食甚分倍加之为复圆分
太隂一时实行
表求太隂一时实行，【无正度，用比例法，】以食甚分，实行求食，【无正时，用比例法】，为食甚时分，以食既分，实行求时，为食既时分。
求正时
太阳平行减黄道根数得黄道余度太阳实经度黄赤道同升度减赤道根数得赤道余度二，余度相减，以二余度入变时，表查时为时差，黄道余大加实防，赤道余大减实防，又加本地与立表之地，所差时分【，如南京差七，时二十八分，北京差二十○分，】为真实防时刻。
天步真原